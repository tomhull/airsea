---
title: "Comparisons of gas transfer and bubble supersaturation parametrisations"
author: "Tom Hull"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
bibliography: airsea.bib
vignette: >
  %\VignetteIndexEntry{O2NCP_validation}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

The `airsea` package provides various parametrisations for the interactions of gases at the air-sea interface.
Here we quickly explore the differences between the parametrisations and point the reader to the relevant references.

```{r start, include=F}
library(airsea)
library(ggplot2)
library(cowplot)
library(reshape2)
```

# The air-sea gas transfer coefficent ($k_w$)

The gas transfer coefficient $k$, also known as the piston velocity, describes the transfer of gas
across the air-water interface.
For low solubility gases (i.e. oxygen) transfer is assumed to be mostly controled by the water-side transfer coefficent $k_w$.
`airsea` provides the bomb C~14~ derived parametrisation of @Wanninkhof1992 (WA92),
the updated version from @Wanninkhof2014 (WA14), 
NG00 based on @Nightingale2000 's dual tracer experiment and the FA11 parametrisation used in NOAA-COAREG from @Fairall2011.

```{r kw_comp, include=F}
out = data.frame()
paramlist = c("NG00", "WA14", "WA92")
for(param in paramlist){
  u10 = seq(1, 25, by = 0.5)
  dat = data.frame(u10, parametrisation = param, K = airsea::kw("O2", 20, u10, 35, method = param))
  out = rbind(out, dat)
}
dat = data.frame(u10, parametrisation = "FA11", K = airsea::kw_L12(u10, 20, 35, gasname = "O2"))
out = rbind(out, dat)
```
```{r kw_plot, echo = F, fig.width=6, fig.height=6}
ggplot(out) +
  geom_line(aes(u10, K, color = parametrisation), size = 1) +
  labs(x = expression(u[10]~(m~s^-1)), y = expression(K[w]~(m~s^-1)))
```

# The bubble supersaturation coefficent ($B$)

`airsea` currently offers the parametrisations of @Woolf1991 and experimentally @Liang2013.
The @Woolf1991 method is derived from calculated bubble fields, is simple to implement but assumes no solubility dependence.
The @Liang2013 parametrisations accounts for changes in solubility though salinity and temperature changes.

```{r bubbles_o2, include = F}
comp_o2 = data.frame(u10 = seq(0.1, 20, length.out = 100))
comp_o2$liang_5 = B_L12(comp_o2$u10, 5, "O2", 35)
comp_o2$liang_10 = B_L12(comp_o2$u10, 10, "O2", 35)
comp_o2$liang_20 = B_L12(comp_o2$u10, 20, "O2", 35)
comp_o2$woolf= bubbleSat("O2", comp_o2$u10)
comp_o2$gas = "O2"

comp = rbind(comp_o2)
```
```{r bubbleplot, echo = F, fig.width=6, fig.height=6}

ggplot(comp) +
  geom_line(aes(u10, woolf, color = "Woolf & Thorpe"), size = 1) +
  geom_line(aes(u10, liang_5, color = "Liang et al @ 5 degrees"), size = 1) +
  geom_line(aes(u10, liang_10, color = "Liang et al @ 10 degrees"), size = 1) +
  geom_line(aes(u10, liang_20, color = "Liang et al @ 20 degrees"), size = 1) +
  facet_grid(gas ~ ., scales = "free_y") +
  labs(x = expression(u10~(m~s^-1)), y = expression(K[w]~(m~s^-1))) +
  scale_color_discrete(name = "Parametrisation", guide = guide_legend(nrow = 2)) +
  theme_minimal() + theme(legend.position = "bottom")
```

For oxygen @Woolf1991 estimates a larger bubble supersaturation at every temperature.

# References



